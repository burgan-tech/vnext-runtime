{
  "ApplicationName": "vnext-core",
  "ConnectionStrings": {
    "Default": "Host=vnext-postgres;Port=5432;Database=vNext_Core;Username=postgres;Password=postgres;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "System.Net.Http.HttpClient.OtlpTraceExporter.LogicalHandler": "Warning",
      "Microsoft.AspNetCore.Routing.EndpointMiddleware": "Information",
      "System.Net.Http.HttpClient.Default.LogicalHandler": "Warning",
      "Microsoft.EntityFrameworkCore.Database.Command": "Warning"
    }
  },
  "vNextApi": {
    "BaseUrl": "http://vnext-app.vnext-core.orb.local",
    "ApiVersion": "1",
    "TimeoutSeconds": 60,
    "MaxRetryAttempts": 3,
    "RetryDelayMilliseconds": 1000,
    "CircuitBreakerFailureThreshold": 20,
    "CircuitBreakerTimeoutSeconds": 60,
    "EnableCircuitBreakerBypass": true,
    "InternalOperationHeader": "X-Internal-Operation"
  },
  "ResponseCompression": {
    "Enable": true,
    "Providers": [
      "gzip"
    ],
    "EnableForHttps": true,
    "MimeTypes": [],
    "ExcludedMimeTypes": []
  },
  "Redis": {
    "Mode": "Standalone",
    "InstanceName": "workflow-api-core",
    "ConnectionTimeout": 5000,
    "DefaultDatabase": 0,
    "Password": "",
    "Ssl": false,
    "Standalone": {
      "EndPoints": [
        "vnext-redis:6379"
      ]
    },
    "RetryPolicy": {
      "MaxRetries": 3,
      "RetryTimeout": 1000
    }
  },
  "Telemetry": {
    "ServiceName": "vnext-app-core",
    "ServiceNamespace": "BBT.Workflow.Orchestration",
    "ServiceVersion": "1.0.0",
    "TracingEnabled": true,
    "MetricsEnabled": true,
    "LoggingEnabled": true,
    "Otlp": {
      "Endpoint": "http://otel-collector:4317",
      "Protocol": "grpc"
    },
    "Tracing": {
      "EnableConsoleExporter": true,
      "EnableOtlpExporter": true,
      "ExcludedPaths": [
        "/health",
        "^/metrics$",
        "/live",
        "/ready",
        "/swagger/*"
      ],
      "AdditionalSources": [
        "BBT.Workflow.BackgroundJobs",
        "BBT.Workflow.SubFlow"
      ]
    },
    "Metrics": {
      "EnableConsoleExporter": true,
      "EnableOtlpExporter": true,
      "AdditionalMeters": []
    },
    "Logging": {
      "EnableConsoleExporter": true,
      "EnableOtlpExporter": true,
      "IncludeFormattedMessage": true,
      "IncludeScopes": true,
      "ParseStateValues": true,
      "ExcludedPaths": [
        "^/health$",
        "^/metrics$",
        "/live",
        "/ready",
        "/swagger/*"
      ],
      "Enrichers": {
        "Headers": [],
        "CustomAttributes": {}
      }
    }
  },
  "AllowedHosts": "*",
  "TaskFactory": {
    "UseObjectPooling": false,
    "MaxPoolSize": 50,
    "InitialPoolSize": 5,
    "EnableMetrics": true,
    "PooledTaskTypes": [
      "ConditionTask",
      "DaprBindingTask",
      "DaprHttpEndpointTask",
      "DaprPubSubTask",
      "DaprServiceTask",
      "DirectTriggerTask",
      "GetInstanceDataTask",
      "HttpTask",
      "HumanTask",
      "NotificationTask",
      "ScriptTask",
      "StartTask",
      "SubProcessTask",
      "TimerTask"
    ]
  },
  "ExecutionApi": {
    "AppId": "vnext-execution-app-core"
  },
  "Vault": {
    "Enabled": false
  },
  "ClickHouse": {
    "Enabled": false,
    "ConnectionString": "Host=vnext-clickhouse;Port=8123;Database=workflow_analytics;Username=default;Password=;",
    "BatchSize": 1000,
    "FlushIntervalSeconds": 5,
    "RetryAttempts": 3,
    "RetryDelayMilliseconds": 1000,
    "Tables": {
      "Instances": "instances",
      "InstanceTransitions": "instance_transitions",
      "InstanceTasks": "instance_tasks"
    }
  },
  "Example": {
    "ApiBaseUrl": "http://localhost:3001"
  },
  "ResultRetry": {
    "MaxRetryAttempts": 3,
    "RetryDelayMilliseconds": 50,
    "UseJitter": true,
    "BackoffType": "Constant",
    "RetryOnErrorCodes": [
      "TransitionLocked",
      "Locked"
    ]
  },
  "ServiceDiscovery": {
    "Enabled": true,
    "BaseUrl": "http://vnext-app-discovery:5000/api/v1",
    "Domain": "discovery",
    "RegistryFlow": "domain-registration",
    "ValidateSsl": false,
    "TimeoutSeconds": 30,
    "MaxRetryAttempts": 3,
    "RetryDelayMilliseconds": 1000,
    "CircuitBreakerFailureThreshold": 5,
    "CircuitBreakerTimeoutSeconds": 30,
    "DiscoveryCacheSeconds": 300,
    "DiscoveryEndpointTemplate": "/discovery/workflows/domain/instances/{0}/functions/data"
  },
  "DaprCache": {
    "StoreName": "statestore"
  }
}
